<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.snapdeal.bulkprocess.dao.FileTrackerDao">

	
		<resultMap id="fileResult"
		type="com.snapdeal.bulkprocess.entity.FileTrackEntity">
		<result property="fileId" column="file_id" />
		<result property="status" column="status" />
		
		<result property="uploadTime" column="upload_time" />
		<result property="totalRows" column="total_rows" />
		<result property="completedRows" column="completed_rows" />
		<result property="userId" column="user_id" />
		<result property="lastExecutedTime" column="last_executed_time" />
		
	</resultMap>

	<select id="getIncompleteFileIds" resultMap="fileResult" >
		SELECT * from filetrack
		where status="INCOMPLETE"
	</select>

	<insert id="insertFileInfo"
		parameterType="com.snapdeal.bulkprocess.entity.FileTrackEntity">
		INSERT INTO filetrack
		(file_id,status,upload_time,total_rows,completed_rows,user_id,last_executed_time)
		VALUES
		(#{fileId},#{status},#{uploadTime},#{totalRows},#{completedRows},#{userId},#{lastExecutedTime})
	</insert>
	
	<select id="getAllFilesInfo" resultMap="fileResult" >
		SELECT file_id,status,upload_time,total_rows,completed_rows,user_id,last_executed_time
		FROM filetrack
	</select>
	
	<select id="getCompletedRowsForFile" parameterType="java.lang.String" resultType="java.lang.Long" >
		SELECT completed_rows
		FROM filetrack
		WHERE file_id =#{fileId}
	</select>
	
	<select id="getLastExecutedTimeForFile" parameterType="java.lang.String" resultType="java.lang.String" >
		SELECT last_executed_time
		FROM filetrack
		WHERE file_id =#{fileId}
	</select>
	
	<select id="getStatusForFile" parameterType="java.lang.String" resultType="java.lang.String" >
		SELECT status
		FROM filetrack
		WHERE file_id =#{fileId}
	</select>



</mapper>