monthMaxDays=[31,28,31,30,31,30,31,31,30,31,30,31];monthMaxDaysLeap=[31,29,31,30,31,30,31,31,30,31,30,31];hideSelectTags=[];function getRealYear(A){return(A.getYear()%100)+(((A.getYear()%100)<39)?2000:1900)}function getDaysPerMonth(B,A){if((A%4)==0){if((A%100)==0&&(A%400)!=0){return monthMaxDays[B]}return monthMaxDaysLeap[B]}else{return monthMaxDays[B]}}function createCalender(J,R,O){var S=new Date();var D=S.getDate();var A=S.getMonth();var L=getRealYear(S);if(!J){var J=L;var R=A}var B=0;for(var P=0;P<document.getElementById("selectYear").options.length;P++){if(document.getElementById("selectYear").options[P].value==J){document.getElementById("selectYear").selectedIndex=P;B=true;break}}if(!B){document.getElementById("selectYear").selectedIndex=0;J=document.getElementById("selectYear").options[0].value}document.getElementById("selectMonth").selectedIndex=R;var F=new Date(J,R,1);var N=F.getDay();continu=true;firstRow=true;var I=0;var Q=0;var K=[];var C=0;while(Q<=getDaysPerMonth(R,J)){if(firstRow){K[C]=document.createElement("TR");if(N>0){while(I<N){K[C].appendChild(document.createElement("TD"));I++}}firstRow=false;var Q=1}if(I%7==0){C++;K[C]=document.createElement("TR")}if(O&&Q==O){var M="calenderChoosenDay";var G="choosenDay";var H="this day is currently selected"}else{if(Q==D&&R==A&&J==L){var M="calenderToDay";var G="toDay";var H="this day today"}else{var M=false;var G="normalDay";var H=false}}var E=document.createElement("TD");E.className=G;if(M){E.id=M}if(H){E.title=H}E.onmouseover=new Function("highLiteDay(this)");E.onmouseout=new Function("deHighLiteDay(this)");if(targetEl){E.onclick=new Function("pickDate("+J+", "+R+", "+Q+")")}else{E.style.cursor="default"}E.appendChild(document.createTextNode(Q));K[C].appendChild(E);I++;Q++}return K}function showCalender(C,E){targetEl=false;if(document.getElementById(E)){targetEl=document.getElementById(E)}else{if(document.forms[0].elements[E]){targetEl=document.forms[0].elements[E]}}var F=document.getElementById("calenderTable");var B=[0,0];var B=getParentOffset(C,B);F.style.left=B[0]+"px";F.style.top=B[1]+"px";F.style.display="block";var D=new RegExp("^([0-9]{2})-([0-9]{2})-([0-9]{4})$");var A=D.exec(targetEl.value);if(A==null){trs=createCalender(false,false,false);showCalenderBody(trs)}else{if(A[1].substr(0,1)==0){A[1]=A[1].substr(1,1)}if(A[2].substr(0,1)==0){A[2]=A[2].substr(1,1)}A[2]=A[2]-1;trs=createCalender(A[3],A[2],A[1]);showCalenderBody(trs)}hideSelect(document.body,1)}function showCalenderBody(A){var C=document.getElementById("calender");while(C.childNodes[0]){C.removeChild(C.childNodes[0])}for(var B in A){C.appendChild(A[B])}}function setYears(E,C){var A=new Date();var D=getRealYear(A);if(E){startYear=D}if(C){endYear=D}document.getElementById("selectYear").options.length=0;var B=0;for(y=C;y>=E;y--){document.getElementById("selectYear")[B++]=new Option(y,y)}}function hideSelect(C,B){if(B>=100){return }var G=C.childNodes.length;for(var L=0;L<G;L++){var N=C.childNodes[L];if(N.tagName=="SELECT"){if(N.id!="selectMonth"&&N.id!="selectYear"){var O=document.getElementById("calenderTable");var H=[0,0];var H=getParentOffset(N,H);var F=H[0];var E=H[0]+N.offsetWidth;var J=H[1];var D=H[1]+N.offsetHeight;var M=O.offsetLeft;var I=O.offsetLeft+O.offsetWidth;var K=O.offsetTop;var A=O.offsetTop+O.offsetHeight;if(((F>=M&&F<=I)||(E<=I&&E>=M)||(F<=M&&E>=I))&&((J>=K&&J<=A)||(D<=A&&D>=K)||(J<=K&&D>=A))){hideSelectTags[hideSelectTags.length]=N;N.style.display="none"}}}else{if(N.childNodes.length>0){hideSelect(N,(B+1))}}}}function closeCalender(){for(var A=0;A<hideSelectTags.length;A++){hideSelectTags[A].style.display="block"}hideSelectTags.length=0;document.getElementById("calenderTable").style.display="none"}function highLiteDay(A){A.className="hlDay"}function deHighLiteDay(A){if(A.id=="calenderToDay"){A.className="toDay"}else{if(A.id=="calenderChoosenDay"){A.className="choosenDay"}else{A.className="normalDay"}}}function pickDate(B,C,A){C++;A=A<10?"0"+A:A;C=C<10?"0"+C:C;if(!targetEl){alert("target for date is not set yet")}else{targetEl.value=B+"-"+C+"-"+A;closeCalender()}}function getParentOffset(B,A){A[0]+=B.offsetLeft;A[1]+=B.offsetTop;if(B.offsetParent){A=getParentOffset(B.offsetParent,A)}return A};