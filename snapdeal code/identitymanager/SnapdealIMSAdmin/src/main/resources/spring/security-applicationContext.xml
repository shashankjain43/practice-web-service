<beans:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd 
						http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.2.xsd">
	<global-method-security pre-post-annotations="enabled" />
	<http auto-config='true' entry-point-ref="authenticaionEntryPoint"
		access-decision-manager-ref="accessDecisionManager">
		<intercept-url pattern="/login" access="IS_AUTHENTICATED_ANONYMOUSLY" />
		<!-- <intercept-url pattern="/static/**" filters="none" /> -->
		<!-- <intercept-url pattern="/mYSDCASH/**" ACCESS="REGISTERED" /> -->
		<!-- <INTERCEPT-URL PATTERN="/DISPLAYLOGGEDUSERCART" ACCESS="REGISTERED" 
			/> -->
		<!-- <INTERCEPT-URL PATTERN="/RELOADMEMcache/**" access="SUPER" /> -->
		<intercept-url pattern="/admin/**" access="admin,imsadmin" />
		<intercept-url pattern="/sdCash/**" access="bulksdcashfileuploader" />

		<!-- <intercept-url pattern="/downloadsubscriber/**" access="SUPER,admin" 
			/> -->
		<!-- <intercept-url pattern="/reports/**" access="SUPER,ccmanager,marketing,content,admin,bd,getaways-bd,mis" 
			/> -->
		<!-- <intercept-url pattern="/sendVerificationEmail" access="unverified" 
			/> -->
		<!-- <intercept-url pattern="/**" access="IS_AUTHENTICATED_ANONYMOUSLY" 
			/> -->
		<form-login login-page="/login" login-processing-url="/login_security_check"
			always-use-default-target="false" default-target-url="/admin"
			authentication-success-handler-ref="customSuccessHandler"
			authentication-failure-handler-ref="customFailureHandler" />
		<logout invalidate-session="true" logout-url="/logout"
			success-handler-ref="sdLogoutSuccessHandler" />
		<remember-me key="snapdealRem" />
	</http>

	<beans:bean id="sdLogoutSuccessHandler"
		class="com.snapdeal.admin.web.security.CustomLogoutSuccessHandler">
	</beans:bean>

	<beans:bean id="accessDecisionManager"
		class="org.springframework.security.access.vote.AffirmativeBased">
		<beans:property name="decisionVoters">
			<beans:list>
				<beans:ref bean="roleVoter" />
				<beans:ref bean="authenticatedVoter" />
			</beans:list>
		</beans:property>
	</beans:bean>
	<beans:bean id="roleVoter"
		class="org.springframework.security.access.vote.RoleVoter">
		<beans:property name="rolePrefix" value="" />
	</beans:bean>
	<beans:bean id="authenticatedVoter"
		class="org.springframework.security.access.vote.AuthenticatedVoter">
	</beans:bean>

	<beans:bean id="customSuccessHandler"
		class="com.snapdeal.admin.web.security.CustomSuccessHandler">
	</beans:bean>
	<beans:bean id="customFailureHandler"
		class="com.snapdeal.admin.web.security.CustomFailureHandler">
		<beans:constructor-arg name="defaultFailureUrl"
			value="/login?authenticated=false" />
	</beans:bean>

	<beans:bean id="userDetailsService"
		class="com.snapdeal.admin.web.security.CustomUserDetailsService">
	</beans:bean>

	<authentication-manager alias="authenticationManager">
		<authentication-provider user-service-ref='userDetailsService'>
			<password-encoder ref="encoder">
				<salt-source ref="saltSource" />
			</password-encoder>
		</authentication-provider>
	</authentication-manager>


	<beans:bean id="saltSource"
		class="org.springframework.security.authentication.dao.SystemWideSaltSource">
		<beans:property name="systemWideSalt"
			value="snapdealsaltforpassword123876heysaltie" />
	</beans:bean>

	<beans:bean id="encoder"
		class="org.springframework.security.authentication.encoding.Md5PasswordEncoder">
	</beans:bean>


	<!-- <beans:bean id="daoAuthenticationProvider" class="org.springframework.security.authentication.dao.DaoAuthenticationProvider"> 
		<beans:property name="userDetailsService" ref="userDetailsService" /> <beans:property 
		name="saltSource" ref="saltSource" /> <beans:property name="passwordEncoder" 
		ref="encoder" /> </beans:bean> -->
	<beans:bean id="authenticaionEntryPoint"
		class="org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint">
		<beans:property name="loginFormUrl" value="/login" />
	</beans:bean>

</beans:beans>